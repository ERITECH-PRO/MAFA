---
// src/components/background/ThreeDBackground.astro

// This is server-side code that runs at build time
// We'll keep it minimal since most of the work is client-side
---

<!-- Container for the Three.js canvas -->
<div id="three-bg" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;"></div>

<!-- Client-side script that runs in the browser -->
<script>
  // This code runs when the component mounts in the browser
  document.addEventListener('DOMContentLoaded', async () => {
    // Load Three.js if not already loaded
    // @ts-ignore - THREE is loaded dynamically from CDN
    if (typeof window !== 'undefined' && typeof window.THREE === 'undefined') {
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';
      script.onload = async () => {
        const { initThreeBackground } = await import("../../assets/scripts/three-background.js");
        initThreeBackground();
      };
      document.head.appendChild(script);
    } else {
    const { initThreeBackground } = await import("../../assets/scripts/three-background.js");
    initThreeBackground();
    }
  });
</script>